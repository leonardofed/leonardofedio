<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Proper setup of a new AWS account</title>

  <meta name="description" content="How to setup a new AWS account with a proper initial configuration">

  <link rel="me" href="https://twitter.com/leonardofed" />
  <link rel="me" href="https://www.linkedin.com/in/leonardofederico" />

  <link rel="stylesheet" href="css/tufte.css">

  <!-- Google Fonts loaded here -->
  <link href='http://fonts.googleapis.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>

  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->

  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
  <script type="text/javascript" src="marginotes.js"></script>

  <script type="text/javascript" src="assets/js/d3.min.js" charset="utf-8"></script>
  <script type="text/javascript" src="assets/js/dataviz.js" charset="utf-8"></script>


  <meta content="Leonardo Federico | Cloud Academy" property="og:site_name">
  <meta content="Leonardo Federico" property="og:title">
  <meta content="article" property="og:type">
  <meta content="./" property="og:url">

  <link rel="canonical" href="index.html">

<style>
  .terminal {
    width: 500px;
  }

  .head-ter {
    height: 25px;
    display: block;
    background: -moz-linear-gradient(top,  #f7f7f7 0%, #cfcfcf 5%, #aaaaaa 100%);
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f7f7f7), color-stop(5%,#cfcfcf), color-stop(100%,#aaaaaa));
    background: -webkit-linear-gradient(top,  #f7f7f7 0%,#cfcfcf 5%,#aaaaaa 100%);
    background: -o-linear-gradient(top,  #f7f7f7 0%,#cfcfcf 5%,#aaaaaa 100%);
    background: -ms-linear-gradient(top,  #f7f7f7 0%,#cfcfcf 5%,#aaaaaa 100%);
    background: linear-gradient(top,  #f7f7f7 0%,#cfcfcf 5%,#aaaaaa 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f7f7f7', endColorstr='#aaaaaa',GradientType=0 );
    border: 1px solid #9c9c9c;
    border-bottom-color: #111;
    border-top-left-radius: 7px;
    border-top-right-radius: 7px;
    text-align: center;
    font-size: 13px;
    line-height: 25px;
    text-shadow: 0 1px 0 rgba(255,255,255,0.6);
    color: #444;
  }

  .shell {
    font-family: Consolas, "Liberation Mono", Courier, monospace;
    font-size: 17px;
    line-height: 28px;
    color: #eeeb82;
    background-color: #3d3d3d;
    overflow: hidden;
    padding: 20px;
    margin: 0;
    border-bottom-left-radius: 7px;
    border-bottom-right-radius: 7px;
    text-align: left;
    display: block;
  }

  </style>
</head>

  <body>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44921644-1', 'auto');
  ga('send', 'pageview');

</script>
    <!--- Header and nav template site-wide -->

<header>
  <nav class="group">
    <a href="index.html">Home</a>
    <a href="about-me.html">About me</a>
    <a href="books.html">Books</a>
    <!--- Archive section
    <a href="archive.html">Archive</a>
    navbar menu -->
  </nav>
  <div class="">
    <br>
    <p>My name is <a href="index.html" rel="me">Leonardo Federico</a></p>
    <br>
    <p>I work on growth operations at <a href="https://cloudacademy.com" desc="A provider-neutral learning platform that helps both companies and individuals learn Cloud Computing technologies.
">Cloud Academy</a> a great place where you get to play with all kinds of amazing cloud computing technologies. Over the years I created several fun projects. I also love chess, reading and writing.</p>
  </div>


</header>

      <h1>Proper setup of a new AWS account</h1>
<p>March 25, 2015</p>
<br>
<a style="color:rgb(255, 87, 34); background-color:rgba(255, 173, 102, 0.07)" href="https://news.ycombinator.com/item?id=11367686">[DISCUSS ON HACKER NEWS]</a> or <a style="color:#0099FF; background-color:rgba(102, 204, 255, 0.07)" href="https://twitter.com/intent/tweet?text=Proper%20setup%20of%20a%20new%20AWS%20account%20http%3A%2F%2Fwww.leonardofed.io%2Faws-setup.html%20via%20%40leonardofed%0D%0A&source=clicktotweet&related=clicktotweet">[SHARE ON TWITTER]</a> or <a style="color:#FE0000; background-color:rgba(102, 204, 255, 0.07)" href="https://www.reddit.com/r/devops/comments/4c344w/a_proper_aws_configurations_for_a_new_account/">[JOIN ON REDDIT]</a>
<br>
<br>

<p>A similar article was originally written by <a href="http://twitter.com/polmolea"> Andrei Polmolea</a> as a part of <a href="https://cloudofficer.co/correctly-setting-up-your-aws-account/">a series on AWS</a>. I'm trying here to complement what Andrei already wrote, delve more into all those topics and give some more valuable insights to a new AWS user. Getting started with AWS account is something tricky especially when you're moving your first steps in the Cloud and you're so impatient to play (exactly as I did when I put this blog up on AWS) with all kinds of these amazing services.
That's why having a solid checklist is something extremely important. Nice things about it? It won't take too much and a couple of extra mins now will save you hours later on.
</p>


<br>
<p><em><b>TL;TR</b> 1. Create a root-account first and use IAM users for everything else. 2. IAM - take care of pwd-policies and set in place a good aws account hierarchy  3. Monitor since day-1</em></p>
<br>

<p>

If you don't have an AWS account yet and you want to get started immediately in a real AWS Management Console. You can create a <a style="color:#0099FF; background-color:rgba(102, 204, 255, 0.07)" href="https://cloudacademy.com">Cloud Academy account</a> and start get started with some of our <a style="color:#1bae08; background-color:#e9f7e6" href="https://cloudacademy.com/labs" desc="Once you start a lab you will access the real AWS console in a live environment. The lab will guide you through the whole process.">Hands-on labs</a>:
<br>
<br>
<li><a style="color:#1bae08; background-color:#e9f7e6" href="https://cloudacademy.com/amazon-web-services/labs/create-your-first-amazon-s3-bucket-2/">Create Your First Amazon S3 Bucket</a></li>
  <li><a style="color:#1bae08; background-color:#e9f7e6" href="https://cloudacademy.com/amazon-web-services/labs/introduction-iam-13/">Introduction to IAM</a></li>
    <li><a style="color:#1bae08; background-color:#e9f7e6" href="https://cloudacademy.com/amazon-web-services/labs/serve-your-files-using-cloudfront-cdn-15/">Serve your files using the CloudFront CDN</a></li>

<h2>1. Signing up - root-account</h2>
<br>
<p>When you sign up for AWS, your account is automatically signed up for all services in Amazon Web Services.
And here's your first smart move: no matter if you're creating a new AWS account for a company or a personal project, make sure you use an email alias (e.g. <strong>aws-root@acme.com</strong>) instead of an actual person's email address.
Keep in mind: there is only one root credential for each AWS account and it has full admin privileges that cannot be revoked.
This your root credential should not be used for day-to-day administration.
From now on, you should use your AWS root account only for these three main reasons:
<br>
<br>
1. You have to set up a new account;<br>
2. You have to update billing information<br>
3. All your IAM Users lost access to the account (e.g. if an IAM policy change accidentally and blocks all users from signing in to the account).<br>
4. Point of contact for security related events
5. For changing the support levels (e.g., basic to developer/business/enterprise)
</p>
<br>

<h2>2. IAM Users - Pwd policies</h2>
<br>
<p>
  Once you've locked away your root-account it's time for <span desc="Each AWS account can have up to 5,000 IAM users.">IAM users</span>. That's what you'll use to access your AWS Management Console for day-to-day administration.
  And first thing you want to care about for new IAM users is: password-policy. Having in place a solid password policy is something that will ensure you don't do anything that will need to be fixed later.
  The IAM console will give <span class="marginnote"><img class="fullwidth" src="http://i.imgur.com/mufN7Bu.png">Secutiry Status - <a href="http://i.imgur.com/mufN7Bu.png" target="_blank"> Full size image</a></span>you a big help as they already support policies that include minimum length and complexity requirements. The <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html">AWS documentation</a> here is great.
  <br>
  <p>
  And after you complete each of these tasks from your root-account, a green check box will light up.
  </p>
<p>
  Once you settled in your pwd policy, you'll go straight to separation of duty.
  Best practice of balacing responsibility among multiple users so that no one person has full control of everything.
</p>
<br>

<h2>2. IAM Users - distributing roles</h2>
  <br>
<p><em>Disclaimer: I found <a href="https://cloudofficer.co/correctly-setting-up-your-aws-account/">this post</a> very comprensive on this part. So I'll report a valuable piece of that. Another comprensive guide here comes from directly from the <a href="http://blogs.aws.amazon.com/security/post/TxQYSWLSAPYVGT/Guidelines-for-when-to-use-Accounts-Users-and-Groups">AWS Blog</a> by <a href="https://twitter.com/etoolguy">Matt Ramsay</a>.</em>
  <br>
  <br>
  Before you even touch any service, <span class="marginnote"><img class="fullwidth" src="http://i.imgur.com/OZfOJz7.png">AWS Mgm Dashboard - <a href="http://i.imgur.com/OZfOJz7.png" target="_blank"> Full size image</a></span>secure your root account!
  Log in, go to Security Credentials (top right part of the screen) and add a multi-factor authentication device for the root user. Then create another user for yourself:</p>
  <br>
  <p>
<br>
    <strong>> Go to Groups.</strong> Create a super admin group with the policy<br> AdministratorAccess (this gives IAM users access to almost everything).

<br>
    <strong>> Go to Users.</strong> Create a user for yourself, adding it to the group <br>you created earlier.
    <br>You can also generate an API key here - make note of it because <br>the secret is not shown again and make sure you never,<br> ever, post it to GitHub (lots of people do that and it's really bad)<br>
    <strong>> Go to Dashboard.</strong> Set a sign-in URL for IAM users (bookmark this) and check that all boxes are green</span>
which means <br>you did everything correctly.
<span class="marginnote"><img class="fullwidth" src="http://i.imgur.com/DXDvqsH.png">AWS account hierarchy - <a href="http://i.imgur.com/DXDvqsH.png" target="_blank"> Full size image</a></span>
</p>
<br>
<p>
  Finally, go to My Account (again, top right of the screen) and set the correct Contact, Currency and Security Challenges settings. Also, enable IAM User Access to Billing Information.
Now logout of the root account and only use the IAM user you created earlier from now on.
  <br>
  <br>Once correctly setup, your AWS account hierarchy will look something like this.<span class="marginnote"><img class="fullwidth" src="http://i.imgur.com/pE2BqQn.png">Email best practice - <a href="http://i.imgur.com/pE2BqQn.png" target="_blank"> Full size image</a></span>
  'Admin-Area' + 'Dev-Area' are new IAM groups.
   The first user of 'Admin-Area' is <strong>root-account+1</strong> <br>(who is also a root user). Email services like gmail allow your email addresses to end in +1, +2, +11, +22 etc.. and you can use that to create unique AWS accounts, yet have the emails delivered to same email address.
   You decide every level of permission for each IAM group. <br><br>A common best practice is revoke any <strong>'DELETE'</strong> privileges from any of the IAM groups (including admin group).
   <br>
   <br>
   <div class="terminal">
        <div class="head-ter"></div>
        <div class="shell">
          <pre><p style="color:rgb(123, 123, 123)">//revoke any 'DELETE' privileges</p>
            {
 "Version": "2012-10-17",
 "Statement": [
 {
     "Sid": "Stmt",
     "Effect": "Deny",
     "Action": [
         "iam:DeactivateMFADevice",
         "iam:DeleteAccessKey",
         "iam:DeleteAccountPasswordPolicy",
         "iam:DeleteGroup",
         "iam:DeleteGroupPolicy",
         "iam:DeleteInstanceProfile",
         "iam:DeleteLoginProfile",
         "iam:DeleteRole",
         "iam:DeleteRolePolicy",
         "iam:DeleteSigningCertificate",
         "iam:DeleteUser",
         "iam:DeleteUserPolicy"
     ],
     "Resource": [
         "*"
     ]
 }
 ]
}</pre>
        </div>
      </div>


</p>
<br>
<br>
  <p>Recap - here the General Best Practices that <a href="https://d0.awsstatic.com/aws-answers/AWS_Secure_Account_Setup.pdf">AWS stongly recommend</a>as mandatory to create a secure system:<p>
<br>
<p>
 <li>Create a strategy to control privilege at the user level.</li>
<li>Monitor and audit your users, and regularly review privileges.</li>
<li>Identify which individuals should interact with the service<br> provider regarding billing, security, and operations matters, and <br>grant authorization
accordingly.</li>
<li>Ensure continuous communication with the service provider,<br> even if individuals change roles or leave the company.</li>
</p>
<br>
<br>
<h2>3. IAM - Access Key</h2>
<br>
<br>
<p>
  You'll face with IAM access keys when will need to sign in your AWS management console thru the API.
  Usually three main scenarios:<br>
  <em>First</em>; you have an application or AWS CLI scripts running on an Amazon EC2 instance<br>
  <em>Second</em>; you need to grant cross-account access with limited permissions to access the trusted account. Great tutorial <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html">here</a>. <br>
  <br>
  The best way to keep your access keys secure over time is to rotate them often. AWS allows each user to have two sets of keys to make key rotation easy.
  And the most of the times, you don't even need a long-term access key that never expires (as you have with an IAM user). So be really careful.
<h2>4. IAM - Two Factor for every new account</h2>
<br>
<p>
  This has turned out to be an essential tool. As shown in above diagrams, enable TFA on Root account and every IAM user account. Enforcing of this policy can be done at the IAM Group level by simply attaching a custom policy. Here is a sample policy that enables TFA for all IAM accounts in that group.
  <br><em>It will take 2 seconds more.</em>
</p>
<br>
<div class="terminal">
     <div class="head-ter"></div>
     <div class="shell">

       <pre><p style="color:rgb(123, 123, 123)">//enables TFA for all IAM accounts</p>
           {
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "Stmt",
      "Effect": "Allow",
      "Action": [
        "*"
      ],
      "Condition": {
        "Null": {
          "aws:MultiFactorAuthAge": "false"
        }
      },
      "Resource": [
        "*"
      ]
    }
  ]
}     </pre>
     </div>
   </div>
   <br>
   <br>
<h2>5. Monitoring</h2>
<br>
<p>
  Monitoring since day 1 is extremely important and AWS provides several different tools to help customers monitor their account activities.
  <li>You can create a security email distribution list to receive <br>security-related notifications</li>
  <li>Create an Amazon Simple Notification Service (SNS)<br> topic for security notifications and subscribe the security email <br>distribution list to the topic. It's pretty good to have fully-customized alerts.</li>
  <li>The AWS documentation says <em>"Configure AWS usage and billing reports"</em>. <br>Good luck. Fortunately <a href="http://reedjessen.com/billgist-makes-aws-better/">this tool</a> will make things a whole lot easier.</li>
  <li>Keep in mind to enable CloudTrail in all regions</li>
  <li>CloudTrail integration with CloudWatch Logs and launch<br> the provided AWS CloudFormation template to create CloudWatch <br>alarms for</li>
  <li>Enable AWS Config. Use the predefined rules <strong>CLOUD_TRAIL_ENABLED</strong><br> and <strong>RESTRICTED_INCOMING_TRAFFIC</strong> to notify the security <br>SNS topic if</li>
  <li>CloudTrail is disabled for the account or if someone creates <br>insecure security group rules.</li>
  <li>Create an S3 bucket for storing monitoring data and configure<br> the bucket policy to allow the appropriate services <br>(CloudTrail or AWS Config are perfect)<br> to store</li>
</p>
<br>
<br>
<p>
  That's pretty much it. Hope you enjoyed this write-up. If you found this useful let me know on <a href="https://twitter.com/leonardofed">@leonardofed</a>.
  <br><em>Next steps</em>: I'll make a checklist as a Gist in my <a href="https://github.com/leonardofed">GitHub profile</a>.
</p>
<br>
<br>

<p>If you really want to deepen your knowledge of Amazon Web Services, I strongly recommend to check out <a style="color:#0099FF; background-color:rgba(102, 204, 255, 0.07)" href="https://cloudacademy.com" desc="A provider-neutral learning platform that helps both companies and individuals learn Cloud Computing technologies.">Cloud Academy</a>.

  You can use the Cloud Academy <a style="color:#1bae08; background-color:#e9f7e6" href="https://cloudacademy.com/labs" desc="Once you start a lab you will access the real AWS console in a live environment. The lab will guide you through the whole process.">Hands-on Labs</a> to do exactly all the stuff that I explained in this post and much more.
</p>

<br>
<a style="color:rgb(255, 87, 34);" href="https://news.ycombinator.com/item?id=11367686">[DISCUSS ON HACKER NEWS]</a> or <a style="color:#0099FF; background-color:rgba(102, 204, 255, 0.07)" href="https://twitter.com/intent/tweet?text=Proper%20setup%20of%20a%20new%20AWS%20account%20http%3A%2F%2Fwww.leonardofed.io%2Faws-setup.html%20via%20%40leonardofed%0D%0A&source=clicktotweet&related=clicktotweet">[SHARE ON TWITTER]</a> or <a style="color:#FE0000; background-color:rgba(102, 204, 255, 0.07)" href="https://www.reddit.com/r/devops/comments/4c344w/a_proper_aws_configurations_for_a_new_account/">[JOIN ON REDDIT]</a>
<br>
<br>
<br>

<script>

  ////////////////////////////////////////////////////
  ////////////////////////////////////////////////////

  $(document).ready(function () {
    var admireesJSON = $.getJSON("https://raw.githubusercontent.com/fdansv/admirees/master/admirees.json", function(data) {
      data = data.reverse()
      var text = data.reduce(function(p,c,i){
        if (i === data.length-1){
          p += "and "
        }
        p += '<a href = "' + c.url + '" desc = "' + c.desc + '" target="_blank">' + c.name
        if (i !== data.length-1){
          p += '</a>, '
        }

        return p
      }, "Here's some people doing awesome work that you may or may not have heard of, that I enjoy hearing about: ")
      $(".admirees").html(text)
      $("a,span").marginotes()
    })
  })

</script>


  </body>
</html>
